var generator_required=[];window.et_panel=window.et_panel||{},function(e){e(document).ready(function(p){window.et_panel=Object.assign(window.et_panel,{generator_section_child_change:function(e){e.prop("checked")?e.parents(".opt-section").find("input:not(.input-section)").prop("checked",!0):e.parents(".opt-section").find("input:not(.input-section)").prop("checked",!1)},generator_subsection_child_change:function(e){e.prop("checked")?e.parents(".opt-subsection").find("input:not(.has-subsection)").prop("checked",!0):e.parents(".opt-subsection").find("input:not(.has-subsection)").prop("checked",!1)},generator_parent_change:function(e){e.prop("checked")&&(e.closest(".has-subsection").find(".opt-item").first().find("input").prop("checked",!0),e.closest(".opt-section.has-subsection").find(".opt-item").first().find("input").prop("checked",!0))},generator_remove_file:function(e){confirm("Are you sure? ")&&p.ajax({method:"POST",url:ajaxurl,dataType:"JSON",data:{action:"et_panel_ajax",type:"css",action_type:"et_generator_remover"},success:function(e){"success"==e.status?(p(".css_generator-info").html(""),p(".css_generator-info").html(e.response.html).addClass("no-file-generated")):alert(e.response.msg)},error:function(){alert("ajax error")}})},generator_calc:function(e){et_panel.generator_calc_system_files(e),et_panel.generator_set_counter()},generator_generate_file:function(e,t){t.preventDefault();var t=e.serializeArray(),s="",r=[],a=p(".et_panel-popup");p.each(t,function(e,t){var a;t.value.includes(",")?(a=t.value.split(","),p.each(a,function(e,t){r.includes(t)||(r.push(t),s+=t+",")})):s+=t.value+","}),s=s.slice(0,-1),a.html('<div class="et-loader ">\t\t\t\t\t<svg class="loader-circular" viewBox="25 25 50 50">\t\t\t\t\t<circle class="loader-path" cx="50" cy="50" r="12" fill="none" stroke-width="2" stroke-miterlimit="10"></circle>\t\t\t\t\t</svg>\t\t\t\t</div>'),p("body").addClass("et_panel-popup-on"),p.ajax({method:"POST",url:ajaxurl,dataType:"JSON",data:{action:"et_panel_ajax",modules:s,type:e.attr("type"),action_type:"et_generator"},success:function(e){a.html(""),a.addClass("loading"),a.prepend('<span class="et_close-popup et-button-cancel et-button"><i class="et-admin-icon et-delete"></i></span>'),a.addClass("panel-popup-import").append(e.response.icon),a.append(e.response.msg),a.append(e.response.btn),a.addClass("active").removeClass("loading"),"success"==e.status&&(p(".css_generator-info").html(""),p(".css_generator-info").html("<h2>Latest generated file:</h2><p><strong>File location: </strong>"+e.response.data.path+"</p><p><strong>File size: </strong>"+e.response.data.size+'</p><span class="et-css-remove et-generated-remove"><span class="dashicons dashicons-trash"></span>Remove</span>').removeClass("no-file-generated"))},error:function(){alert("ajax error")}})},generator_set_counter:function(l){var a=0,s=0,e=p(".etheme-generator-head .counter-size"),t=p(".etheme-generator-head .counter-value"),r=p(".etheme-generator-head .counter-value-percent"),n=parseInt(e.data("max_size")),o=parseInt(e.data("stroke-dasharray-start")),i=parseInt(e.data("stroke-dasharray-end")),c=p(".etheme-generator-footer button");p(".etheme-css-generator .et_generator-form input:not(.has-subsection):checked").each(function(e,t){s++,p(t).attr("data-size")&&(a=parseFloat(parseFloat(a)+parseFloat(p(t).attr("data-size"))).toFixed(1))}),1<s?c.removeClass("et-button-dark-grey").addClass("et-button-green").removeAttr("disabled"):c.removeClass("et-button-green").addClass("et-button-dark-grey").attr("disabled",1),t.text("~"+a+"Kb");c=(c=a/n*100).toFixed(1);r.text(c="~"+(c=100<c?100:c)+"%"),p(e).css("strokeDasharray",a/n*o+"px "+i+"px"),p(".etheme-page-content").addClass("primary-counted")},generator_calc_system_files:function(e){var t,a=p(".opt-section.required"),s=a.find(".size-value"),r=s.attr("data-size"),n=a.find(".input-section");e&&!e.prop("checked")?(e.attr("data-required")&&(t=JSON.parse(e.attr("data-required")),p.each(t,function(e,t){generator_required.includes(e)&&(generator_required.splice(e,1),r=parseFloat(parseFloat(r)-parseFloat(t)).toFixed(1),s.html(r),s.attr("data-size",r),n.find("input").attr("data-size",r))})),et_panel.generator_calc_section(e,!1)):e&&et_panel.generator_calc_section(e,!0),p(".etheme-css-generator .et_generator-form input:checked").each(function(e,t){p(".etheme-page-content").hasClass("primary-counted")||et_panel.generator_calc_section(p(t),!0),p(t).attr("data-required")&&(t=JSON.parse(p(t).attr("data-required")),p.each(t,function(e,t){generator_required.includes(e)||(generator_required.push(e),r=parseFloat(parseFloat(r)+parseFloat(t)).toFixed(1),s.html(r),s.attr("data-size",r),a.find("input").attr("data-size",r))}))})},generator_calc_section:function(e,t){if(!e.parents(".opt-section").hasClass("required")){var a,s=e.closest(".opt-section"),r=s.find(".real-size").first().attr("data-size"),n=e.closest(".opt-subsection.has-subsection"),o=n.find(".real-size").attr("data-size"),i=0,c=0;if(e.hasClass("has-subsection")&&p(".etheme-page-content").hasClass("primary-counted"))t?(a=s.find(".opt-subsection.has-subsection input.has-subsection").parent(),p.each(a,function(){var e=p(this).find(".real-size"),t=p(this).find(".size-value").attr("data-size");e.html(t).attr("data-size",t)}),i=e.attr("data-size"),e.closest(".opt-item").find(".real-size").html(i).attr("data-size",i),c=parseFloat(parseFloat(r)+parseFloat(e.attr("data-size"))).toFixed(1)):(i=0,a=s.find(".opt-subsection.has-subsection input.has-subsection").parent(),p.each(a,function(){p(this).find(".real-size").html(0).attr("data-size",0)}),c=parseFloat(parseFloat(r)-parseFloat(e.attr("data-size"))).toFixed(1),e.closest(".opt-item").find(".real-size").html(i).attr("data-size",i));else{if(e.hasClass("has-subsection"))return;c=t?(i=parseFloat(parseFloat(o)+parseFloat(e.attr("data-size"))).toFixed(1),parseFloat(parseFloat(r)+parseFloat(e.attr("data-size"))).toFixed(1)):(i=parseFloat(parseFloat(o)-parseFloat(e.attr("data-size"))).toFixed(1),parseFloat(parseFloat(r)-parseFloat(e.attr("data-size"))).toFixed(1))}(i<0||isNaN(i))&&(i=0),(c<0||isNaN(c))&&(c=0),n.find(".real-size").html(i).attr("data-size",i),s.find(".real-size").first().html(c).attr("data-size",c)}}});var e={1:{selector:".opt-section.has-subsection input.input-section.has-subsection",type:"change",callback:et_panel.generator_section_child_change},2:{selector:".opt-subsection.has-subsection input.has-subsection",type:"change",callback:et_panel.generator_subsection_child_change},3:{selector:".opt-item input",type:"change",callback:et_panel.generator_parent_change},4:{selector:".et-css-remove",type:"click",callback:et_panel.generator_remove_file},5:{selector:".etheme-css-generator .et_generator-form input",type:"change",callback:et_panel.generator_calc},6:{selector:".etheme-css-generator .et_generator-form input",type:"ready",callback:et_panel.generator_calc},7:{selector:"form.et_generator-form",type:"submit",callback:et_panel.generator_generate_file}};p.each(e,function(e,t){"ready"==t.type?p(document).ready(function(e){t.callback(p(this),e)}):p(document).on(t.type,t.selector,function(e){t.callback(p(this),e)})})})}(jQuery,window.et_panel);